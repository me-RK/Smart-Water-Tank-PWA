import{d as e,r as t}from"./vendor-Dw3b2ko0.js";import{u as s,a,j as r,i as n}from"./index-1rMrzTej.js";import{M as l,q as c,r as i,h as o,X as d}from"./icons-DUa41JBP.js";const u=()=>{const a=e(),{sendMessage:r,isConnected:n}=s(),l=t.useRef(!1),c=t.useRef(null),i=t.useRef(r);t.useEffect(()=>{i.current=r},[r]);const o=t.useCallback(()=>{c.current&&clearInterval(c.current);const e=(()=>{const e=localStorage.getItem("dashboardSyncInterval");return e?parseInt(e,10):5e3})();n&&e>0&&(c.current=setInterval(()=>{i.current({type:"getAllData"})},e))},[n]),d=t.useCallback(()=>{c.current&&(clearInterval(c.current),c.current=null)},[]);return t.useEffect(()=>{if(!n)return void d();const e=a.pathname;return"/dashboard"===e?(l.current||(i.current({type:"getAllData"}),l.current=!0),o()):"/settings"===e?(d(),l.current||(i.current({type:"getAllData"}),l.current=!0)):d(),()=>{"/dashboard"!==e&&d()}},[a.pathname,n,o,d]),t.useEffect(()=>{l.current=!1},[a.pathname]),t.useEffect(()=>()=>{d()},[d]),{startDashboardSync:o,stopDashboardSync:d}},m=({className:e="",showLabel:t=!1})=>{const{theme:s,actualTheme:n,toggleTheme:o}=a(),d=()=>{switch(s){case"light":return"Switch to dark mode";case"dark":return"Switch to system theme";case"system":return"Switch to light mode";default:return"Toggle theme"}};return r.jsxs("button",{onClick:o,className:`\n        flex items-center space-x-2 px-3 py-2 rounded-lg\n        text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\n        hover:bg-gray-100 dark:hover:bg-gray-700 \n        transition-all duration-200 ease-in-out\n        focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n        dark:focus:ring-offset-gray-800\n        ${e}\n      `,title:d(),"aria-label":d(),children:[r.jsx("div",{className:"flex items-center justify-center w-5 h-5",children:"system"===s?r.jsx(l,{className:"w-4 h-4"}):"dark"===n?r.jsx(c,{className:"w-4 h-4"}):r.jsx(i,{className:"w-4 h-4"})}),t&&r.jsx("span",{className:"text-sm font-medium",children:(()=>{switch(s){case"light":return"Light";case"dark":return"Dark";case"system":return"System";default:return"Theme"}})()})]})},h=({className:e="",showLabel:s=!1})=>{const[a,l]=t.useState(null),[c,i]=t.useState(!1),[u,m]=t.useState(!1),[h,x]=t.useState(!1);t.useEffect(()=>{m(n());const e=e=>{e.preventDefault(),l(e),i(!0)},t=()=>{m(!0),i(!1),l(null)};window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t);const s=/iPad|iPhone|iPod/.test(navigator.userAgent),a=window.matchMedia("(display-mode: standalone)").matches;return s&&!a&&i(!0),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t)}},[]);const f=()=>{x(!1)};return u?null:c?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:async()=>{if(a){a.prompt();const{outcome:e}=await a.userChoice;l(null),i(!1)}else x(!0)},className:`\n          flex items-center space-x-2 px-3 py-2 rounded-lg\n          text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\n          hover:bg-gray-100 dark:hover:bg-gray-700 \n          transition-all duration-200 ease-in-out\n          focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n          dark:focus:ring-offset-gray-800\n          ${e}\n        `,title:"Install App","aria-label":"Install Smart Water Tank app",children:[r.jsx("div",{className:"flex items-center justify-center w-5 h-5",children:r.jsx(o,{className:"w-4 h-4"})}),s&&r.jsx("span",{className:"text-sm font-medium",children:"Install App"})]}),h&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Install App on iOS"}),r.jsx("button",{onClick:f,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:r.jsx(d,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-medium",children:"1"}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Tap the ",r.jsx("strong",{children:"Share"})," button at the bottom of your Safari browser"]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-medium",children:"2"}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Scroll down and tap ",r.jsx("strong",{children:'"Add to Home Screen"'})]})]}),r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-medium",children:"3"}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Tap ",r.jsx("strong",{children:'"Add"'})," to install the app on your home screen"]})]})]}),r.jsx("div",{className:"mt-6 flex justify-end",children:r.jsx("button",{onClick:f,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Got it!"})})]})})]}):null};export{h as P,m as T,u};
